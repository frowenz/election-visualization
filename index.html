<!DOCTYPE html><html><head> <meta charset="utf-8"/> <link rel="icon" href="data:;base64,iVBORw0KGgo="/> <title>Election Trends Visualization</title> <style>body{background-color: #111; color: #eee; /* i.e., non-SVG text color */}svg text{fill: #eee; /* SVG text color */}/* created with help from https://grid.layoutit.com/ */ #grid-container{display: grid; grid-template-columns: 3fr 2fr; grid-template-rows: 2fr 7fr 1fr; gap: 0px 0px; grid-template-areas: 'bal bal' /* these names only matter for the "grid-area" properties below */ 'map scat' 'time mode'; align-items: center; justify-items: center;}#cell-balance{grid-area: bal; /* make this div always fill out the containing cell */ width: 100%; height: 100%;}#cell-us-map{grid-area: map;}#cell-scatter{grid-area: scat;}#cell-timeline{grid-area: time;}#cell-mode{grid-area: mode;}/* end of specifying the CSS grid layout */ .stateHex{/* the per-state hexagons */ stroke-width: 0;}.stateHexOutline{/* the outline of the per-state hexagons */ stroke-width: 0;}.stateID{/* the state abbreviations inside each hex */ font-size: 12px; font-family: sans-serif; /* https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/text-anchor */ text-anchor: middle; /* https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/dominant-baseline */ dominant-baseline: middle; /* https://developer.mozilla.org/en-US/docs/Web/CSS/text-shadow */ text-shadow: -1px -1px 3px #000, 0px -1px 3px #000, 1px -1px 3px #000, -1px 0px 3px #000, 1px 0px 3px #000, -1px 1px 3px #000, 0px 1px 3px #000, 1px 1px 3px #000; /* so that mouseovers respond to state hexs, but not the abbreviation text */ pointer-events: none; opacity: 0.85;}.stateScat{/* the per-state marks inside the scatterplot */ stroke: white; stroke-opacity: 1; stroke-width: 1.3; fill: black; fill-opacity: 0.1;}#cell-balance text, /* text in the balance bars, */ #scat-axes text, /* and identifying X and Y axes of the scatterplot, */ #mode-form, /* and the radiobutton labels underneath it, */ #timeline-label /* and label showing the year on the timeline */{font-size: 16px; font-family: sans-serif; text-anchor: middle;}#cell-balance text{font-size: 18px; dominant-baseline: middle;}#y-axis{dominant-baseline: text-bottom;}#x-axis{dominant-baseline: hanging;}#scat-canvas{outline: #888 solid 1px;}.hide{visibility: hidden;}.tooltip{position: absolute; display: none; background-color: #3a3535; border-radius: 5px; padding: 5; font-size: 18px;}.stateHexOutline{stroke-width: unset; pointer-events: none;}table{width: 240px;}</style></head><body> <div id="thevis" class="hide"> <div id="grid-container"> <div id="cell-balance"></div><div id="cell-us-map"><svg id="us-map"></svg></div><div id="cell-scatter" style="position: relative"> <div> <canvas id="scat-canvas"></canvas> </div><svg id="scat-axes" style="position: absolute;"> <text id="y-axis">#y-axis</text> <text id="x-axis">#x-axis</text> </svg> <svg id="scat-marks-container" style="position: absolute;"> <g id="scat-marks"></g> </svg> </div><div id="cell-timeline"> <form id="timeline-form"> <label id="timeline-label" for="timeline" style="text-align: right"> Election Year <span id="year">????</span> </label> <input type="range" min="0" max="0" id="timeline" name="year" style="width: 30em"/> </form> </div><div id="cell-mode"> <form id="mode-form" name="mode-form"></form> </div></div></div><script type="module"> import{d3, parm, glob}from './common.js'; import * as hex from './hexmap.js'; import * as p3 from './p3.js'; window.addEventListener('load', ()=> d3.select('#thevis').classed('hide', false)); hex.mapResize('us-map', parm.hexWidth); p3.balanceInit('cell-balance', 'balance'); p3.canvasInit('scat-canvas'); p3.scatLabelPos('scan-canvas'); function keydownDo(evt){let logAllKeys=false; switch (evt.key){case 'd': glob.currentAbbrHide=!glob.currentAbbrHide; d3.selectAll('.stateID').classed('hide', glob.currentAbbrHide); break; default: if (logAllKeys){console.log(`another key: ${evt.shiftKey ? 'shift ' : ''}|${evt.key}|`);}break;}}Promise.all( ['votes', 'hexRC', 'candidateNames', 'stateNames'].map((fn)=> d3.csv(`./data/${fn}.csv`).then((data)=> (glob.csvData[fn]=data)) ) ).then(()=>{hex.mapFill( 'us-map', glob.csvData.hexRC.map((d)=> hex.gen(parm.hexWidth, parm.hexScale, d.StateAbbr, +d.row, +d.col) ) ); p3.scatMarksInit('scat-marks', glob.csvData.votes); p3.dataProc(glob); p3.visInit(glob); p3.formsInit('timeline', 'year', glob.years, 'mode-form'); const initialYear=glob.years.slice(-1); const initialMode='RVD'; let initialShowData=false; initialShowData=true; if (initialShowData){document.getElementById('timeline-form').year.value=initialYear; document.getElementById('timeline').click(); document.getElementById(initialMode).click();}document.addEventListener('keydown', keydownDo);}); window.hack={d3, glob, parm,}</script></body>